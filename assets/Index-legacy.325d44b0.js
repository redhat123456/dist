!function(){function e(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t,n,r,a,i,s){try{var l=e[i](s),o=l.value}catch(c){return void n(c)}l.done?t(o):Promise.resolve(o).then(r,a)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(a,i){var s=e.apply(n,r);function l(e){t(s,a,i,l,o,"next",e)}function o(e){t(s,a,i,l,o,"throw",e)}l(void 0)}))}}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(o){l=!0,a=o}finally{try{s||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=document.createElement("style");s.innerHTML=".person{width:100%}.person .el-card__header{padding:8px;text-align:center}.person-active{background-color:#dcecfc}.el-dialog__body{overflow-y:auto;max-height:50vh!important}\n",document.head.appendChild(s),System.register(["./useComposables-legacy.b3cf5d97.js","./vendor-legacy.5dd500bd.js","./useRequestor-legacy.7584c3c3.js","./index-legacy.0726abb6.js"],(function(t){"use strict";var a,i,s,l,o,c,u,d,p,f,v;return{setters:[function(e){a=e.c,i=e.u,s=e.a},function(e){l=e.r,o=e.w,c=e.d,u=e.h,d=e.e},function(e){p=e.u,f=e.a},function(e){v=e.n}],execute:function(){var h=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},m=h;function g(e,t){return p.request({url:"".concat(m.Basic,"/").concat(e),data:t,method:"PUT"})}function y(e){return p.request({url:"".concat(m.Basic,"/").concat(e),method:"DELETE"})}function b(e,t){return p.uploadFile({url:m.Faces(e)},{data:t,file:null})}m.Basic="/person",m.Face="/face",m.Faces=function(e){return"".concat(h.Basic,"/").concat(e,"/face")};var x=a((function(){var t=r(i(0),2),a=t[0],v=t[1],h=l({page:1,size:10,name:"",title:""}),g=function(){var e=n(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r=h.value,p.request({url:m.Basic,params:r});case 2:return t=e.sent,n=t.data,v(n.total),e.abrupt("return",n.items);case 6:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),x=r(s(g,[]),3),_=x[0],w=x[1],k=x[2],R=function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.exports.MessageBox.confirm("删除人员的同时也会删除他所有的人脸照片！","警告",{type:"error",cancelButtonText:"取消",confirmButtonText:"确定"}).then(n(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y(t);case 3:n=e.sent,r=n.status_code,a=n.status_info,d.exports.Message[0===r?"success":"error"](a),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.prev=11,_(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,9,11,14]])})))).catch((function(){}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();o(h,_,{deep:!0});var S="all",C=r(i(S),2),z=C[0],T=C[1],P=r(i(!1),2),B=P[0],A=P[1],E=r(i([]),2),q=E[0],j=E[1],F=c((function(){for(var e=[],t=0;t<q.value.length;t+=8)e.push(q.value.slice(t,t+8));return e})),I=u({page:1,size:50}),D=l(0),M=function(){var e=n(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(t),e.t0=t,e.next=e.t0===S?4:20;break;case 4:return e.prev=4,A(!0),e.next=8,l=I.page,o=I.size,p.request({url:m.Face,params:{page:l,size:o}});case 8:n=e.sent,r=n.data,j(r.items),D.value=r.total,e.next=16;break;case 14:e.prev=14,e.t1=e.catch(4);case 16:return e.prev=16,A(!1),e.finish(16);case 19:return e.abrupt("break",35);case 20:return e.prev=20,A(!0),e.next=24,s=t,p.request({url:"".concat(m.Basic,"/").concat(s)});case 24:a=e.sent,i=a.data,j(i.faces),e.next=31;break;case 29:e.prev=29,e.t2=e.catch(20);case 31:return e.prev=31,A(!1),e.finish(31);case 34:return e.abrupt("break",35);case 35:case"end":return e.stop()}var s,l,o}),e,null,[[4,14,16,19],[20,29,31,34]])})));return function(t){return e.apply(this,arguments)}}();o(I,(function(){return M(S)}),{deep:!0}),M(S);var $=r(i([]),2),L=$[0],U=$[1],G=r(i(!1),2),H=G[0],O=G[1];o(H,(function(e){return!e&&U([])}));var V=function(){var e=n(regeneratorRuntime.mark((function e(){var t,n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},L.value.forEach((function(e,n){return t[n]=e})),e.prev=2,e.next=5,b(z.value,t);case 5:n=e.sent,r=n.data,a=r.status_code,i=r.status_info,d.exports.Message[0===a?"success":"error"](i),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),f("error",e.t0.message.includes("413")?"图片过大，上传失败~":"未知错误，请联系管理员~");case 13:return e.prev=13,U([]),O(!1),M(z.value),e.finish(13);case 18:case"end":return e.stop()}}),e,null,[[2,10,13,18]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.exports.MessageBox.confirm("确定要删除吗？","警告",{type:"error",cancelButtonText:"取消",confirmButtonText:"确定"}).then(n(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i=t,p.request({url:"".concat(m.Face,"/").concat(i),method:"DELETE"});case 3:n=e.sent,r=n.status_code,a=n.status_info,d.exports.Message[0===r?"success":"error"](a),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.prev=11,M(z.value),e.finish(11);case 14:case"end":return e.stop()}var i}),e,null,[[0,9,11,14]])})))).catch((function(){}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{files:L,loading:k,records:w,total:a,handleReset:function(){h.value.page=1,h.value.size=10,h.value.name="",h.value.title="",M(S),I.page=1,I.size=50},handleDelete:R,handleChangeSize:function(e){return h.value.size=e},handleChangePage:function(e){return h.value.page=e},params:h,request:_,visible:H,setVisible:O,handleChange:function(t,n){return t&&U(e(n.map((function(e){return e.raw}))))},handleRemove:function(){},handleRemoveFace:N,handleCreateFace:function(e){O(!0),T(e)},handleHttpRequest:V,state:I,faces:q,stateTotal:D,faceGroups:F,faceLoading:B,defaultActive:S,currentPerson:z,handleSelectPerson:M,handleChangeStateSize:function(e){return I.size=e},handleChangeStatePage:function(e){return I.page=e}}}));var _=a((function(){var e=x.serviceDiscovery().request,t=r(i(),2),a=t[0],s=t[1],o=r(i("INIT"),2),f=o[0],v=o[1],h=r(i(!1),2),y=h[0],b=h[1],_=r(i(!1),2),w=_[0],k=_[1],R=u({name:"",title:""}),S=u({name:[{required:!0,message:"请填写姓名"}],title:[{required:!0,message:"请填写职位"}]}),C=l(null),z=function(){var e;v("INIT"),k(!1),b(!1),null===(e=C.value)||void 0===e||e.resetFields(),s(),R.name="",R.title=""},T=function(){e(),z()},P=function(){var e=n(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=C.value)||void 0===t?void 0:t.validate();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:return e.prev=8,b(!0),e.next=12,i=R,p.request({url:m.Basic,data:i,method:"POST"});case 12:n=e.sent,r=n.status_code,a=n.status_info,d.exports.Message[0===r?"success":"error"](a),e.next=20;break;case 18:e.prev=18,e.t1=e.catch(8);case 20:return e.prev=20,T(),e.finish(20);case 23:case"end":return e.stop()}var i}),e,null,[[0,5],[8,18,20,23]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=n(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=C.value)||void 0===t?void 0:t.validate();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:return e.prev=8,b(!0),e.next=12,g(a.value,R);case 12:n=e.sent,r=n.status_code,i=n.status_info,d.exports.Message[0===r?"success":"error"](i),e.next=20;break;case 18:e.prev=18,e.t1=e.catch(8);case 20:return e.prev=20,T(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[0,5],[8,18,20,23]])})));return function(){return e.apply(this,arguments)}}(),A=c((function(){return"CREATE"===f.value})),E=c((function(){return A.value?P:B})),q=c((function(){return A.value?"添加人员":"编辑人员"}));return{rules:S,model:R,visible:w,loading:y,formRef:C,headerText:q,setMode:v,handler:E,handleInit:z,handleCreateBefore:function(){v("CREATE"),k(!0)},handleUpdateBefore:function(e){s(e.id),R.name=e.name,R.title=e.title,v("UPDATE"),k(!0)}}})),w={setup:function(e,t){var n=_.serviceDiscovery();return{headerText:n.headerText,visible:n.visible,loading:n.loading,formRef:n.formRef,rules:n.rules,model:n.model,handleInit:n.handleInit,handler:n.handler}}},k={},R=v(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{width:"25%",title:e.headerText,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[n("el-form",{ref:"formRef",attrs:{"label-position":"top",model:e.model,rules:e.rules}},[n("el-form-item",{attrs:{label:"姓名",prop:"name"}},[n("el-input",{model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),n("el-form-item",{attrs:{label:"职位",prop:"title"}},[n("el-input",{model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),n("el-form-item",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"warning",icon:"el-icon-close",loading:e.loading},on:{click:e.handleInit}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-check",loading:e.loading},on:{click:e.handler}},[e._v("提交")])],1)],1)],1)}),[],!1,S,null,null,null);function S(e){for(var t in k)this[t]=k[t]}var C=function(){return R.exports}(),z={setup:function(e,t){var n=_.serviceDiscovery().handleCreateBefore,r=x.serviceDiscovery();return{handleCreateBefore:n,params:r.params,loading:r.loading,request:r.request,handleReset:r.handleReset}}},T={},P=v(z,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-tooltip",{attrs:{effect:"dark",content:"刷新"}},[n("el-button",{attrs:{circle:"",size:"small",type:"primary",icon:"el-icon-refresh",loading:e.loading},on:{click:e.request}})],1),n("el-divider",{attrs:{direction:"vertical"}}),n("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus",loading:e.loading},on:{click:e.handleCreateBefore}},[e._v("添加人员")]),n("el-divider",{attrs:{direction:"vertical"}}),n("el-input",{staticClass:"w-200",attrs:{clearable:"",size:"small",placeholder:"姓名"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),n("el-divider",{attrs:{direction:"vertical"}}),n("el-input",{staticClass:"w-200",attrs:{clearable:"",size:"small",placeholder:"职位"},model:{value:e.params.title,callback:function(t){e.$set(e.params,"title",t)},expression:"params.title"}}),n("el-divider",{attrs:{direction:"vertical"}}),n("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-refresh-left",loading:e.loading},on:{click:e.handleReset}},[e._v("重置")])],1)}),[],!1,B,null,null,null);function B(e){for(var t in T)this[t]=T[t]}var A=function(){return P.exports}(),E={setup:function(e,t){var n=_.serviceRegister().handleUpdateBefore,r=x.serviceDiscovery();return{handleUpdateBefore:n,params:r.params,faceGroups:r.faceGroups,files:r.files,state:r.state,total:r.total,faceLoading:r.faceLoading,records:r.records,visible:r.visible,setVisible:r.setVisible,stateTotal:r.stateTotal,defaultActive:r.defaultActive,currentPerson:r.currentPerson,handleSelectPerson:r.handleSelectPerson,handleRemove:r.handleRemove,handleChange:r.handleChange,handleHttpRequest:r.handleHttpRequest,handleDelete:r.handleDelete,handleChangeSize:r.handleChangeSize,handleChangePage:r.handleChangePage,handleChangeStateSize:r.handleChangeStateSize,handleChangeStatePage:r.handleChangeStatePage,handleCreateFace:r.handleCreateFace,handleRemoveFace:r.handleRemoveFace}}};E.components=Object.assign({RecordsToolbar:A,Instance:C},E.components);var q={},j=v(E,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("RecordsToolbar"),n("el-divider"),n("el-row",{staticClass:"person"},[n("el-col",{attrs:{span:4}},[n("div",{on:{click:function(t){return e.handleSelectPerson(e.defaultActive)}}},[n("el-card",{class:e.currentPerson===e.defaultActive?"person-active":null,staticStyle:{cursor:"pointer"},attrs:{shadow:"hover","body-style":{padding:"8px",textAlign:"center"}}},[n("span",[e._v("所有人")])])],1),e._l(e.records,(function(t){return n("div",{key:t.id,on:{click:function(n){e.handleSelectPerson(String(t.id))}}},[n("el-card",{class:e.currentPerson===String(t.id)?"person-active":null,staticStyle:{cursor:"pointer","margin-top":"16px"},attrs:{shadow:"hover","body-style":{padding:"8px",textAlign:"center"}},scopedSlots:e._u([{key:"header",fn:function(){return[n("span",[e._v(e._s(t.id))]),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(t.name))]),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},[n("el-button-group",[n("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(n){e.handleCreateFace(String(t.id))}}},[e._v("添加")]),n("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdateBefore(t)}}},[e._v("编辑")]),n("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.id)}}},[e._v("删除")])],1)],1)],1)}))],2),n("el-col",{attrs:{span:19,offset:1}},[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.faceLoading,expression:"faceLoading"}],attrs:{shadow:"never","body-style":{padding:"16px"}}},[e.faceGroups.length?n("div",e._l(e.faceGroups,(function(t,r){return n("el-row",{key:r,style:{marginTop:r?"16px":0},attrs:{gutter:16,justify:t.length<8?"start":" space-between"}},e._l(t,(function(t){return n("el-col",{key:t.image,attrs:{span:3}},[n("el-card",{attrs:{shadow:"hover","body-style":{padding:0}}},[n("el-image",{staticStyle:{width:"100%"},attrs:{src:t.image,"preview-src-list":[t.image]}}),n("div",{staticStyle:{padding:"8px","text-align":"center"}},[n("div",[n("span",[e._v(e._s(t.id))]),e.currentPerson===e.defaultActive&&t.person?[n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(t.person.name))])]:e._e()],2),n("el-button",{staticStyle:{width:"100%","margin-top":"8px"},attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(n){return e.handleRemoveFace(t.id)}}},[n("span",[e._v("删除")])])],1)],1)],1)})),1)})),1):n("el-empty",{attrs:{description:"未发现照片记录"}})],1)],1)],1),n("el-divider"),n("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[n("el-row",{attrs:{type:"flex",align:"middle"}},[n("el-tag",{staticStyle:{"margin-right":"16px"},attrs:{size:"small",effect:"dark"}},[e._v("人员分页")]),n("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total,"page-size":e.params.size,"page-sizes":[10,30,50,100],"current-page":e.params.page},on:{"size-change":e.handleChangeSize,"current-change":e.handleChangePage}})],1),n("el-row",{attrs:{type:"flex",align:"middle"}},[n("el-tag",{staticStyle:{"margin-right":"16px"},attrs:{size:"small",effect:"dark"}},[e._v("人脸分页")]),n("el-pagination",{staticClass:"text-align-right",attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.stateTotal,"page-size":e.state.size,"page-sizes":[10,30,50,100,150,200],"current-page":e.state.page},on:{"size-change":e.handleChangeStateSize,"current-change":e.handleChangeStatePage}})],1)],1),n("Instance"),n("el-dialog",{attrs:{width:"25%",title:"添加人脸照片",visible:e.visible},on:{"update:visible":function(t){e.visible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{attrs:{size:"small",icon:"el-icon-close"},on:{click:function(t){return e.setVisible(!1)}}},[e._v("取消")]),n("el-button",{attrs:{size:"small",icon:"el-icon-upload2",type:"success",disabled:!e.files.length},on:{click:e.handleHttpRequest}},[e._v("上传")])]},proxy:!0}])},[n("el-upload",{staticStyle:{"text-align":"center"},attrs:{drag:"",action:"",multiple:"","with-credentials":"",accept:".jpg,.jpeg,.png","on-remove":e.handleRemove,"on-change":e.handleChange,"file-list":e.files,"auto-upload":!1}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])])]),e._v(" "+e._s(e.files)+" ")],1)],1)}),[],!1,F,null,null,null);function F(e){for(var t in q)this[t]=q[t]}var I=function(){return j.exports}(),D={setup:function(e,t){return x.serviceRegister(),{}}};D.components=Object.assign({Records:I},D.components);var M={},$=v(D,(function(){var e=this.$createElement;return(this._self._c||e)("Records")}),[],!1,L,null,null,null);function L(e){for(var t in M)this[t]=M[t]}t("default",function(){return $.exports}())}}}))}();
