import{f as e}from"./Apis.c306c359.js";import{r as t,d as n,w as a}from"./vendor.b8049c8b.js";import{f as s,u as l,b as r,c as i}from"./Apis.851e51bb.js";import{c as o,u as c,a as d}from"./useComposables.07b7fc4f.js";import{n as p}from"./index.a21b1831.js";import"./useRequestor.ce90c02e.js";const u=o((function(){const o=t([]),[p,u]=c({}),[m,v]=c();s().then((({data:e})=>u(e))),e().then((({data:e})=>v(e.channels.map((e=>e.name)))));const[f,g]=c(0),h=t({page:1,size:30,name:void 0,camera:void 0,time_start:void 0,time_end:void 0}),[_,b,y]=d((async()=>{const{data:e}=await r(h.value);return g(e.total),e.items}),[]),w=n((()=>{const e=[];for(let t=0;t<b.value.length;t+=6)e.push(b.value.slice(t,t+6));return e})),k=n((()=>b.value.map((e=>e.image))));return a(o,(e=>{h.value.time_end=(null==e?void 0:e[1])?i(null==e?void 0:e[1]):void 0,h.value.time_start=(null==e?void 0:e[0])?i(null==e?void 0:e[0]):void 0})),a(h,(()=>setTimeout(_,1e3)),{deep:!0}),{total:f,params:h,loading:y,request:_,handleReset:()=>{h.value.page=1,h.value.size=30,h.value.name=void 0,h.value.camera=void 0,o.value=[]},handlePreview:e=>{const t=document.getElementById("fuck-wrapper");t&&document.body.removeChild(t);const n=e=>`\n        <div style="padding: 16px;">\n          <p>名字：谭前程</p>\n          <p>事件编号：${e.id}</p>\n          <p>事件名称：${e.name}</p>\n          <p>摄像头名称：${e.camera}</p>\n          <p>置信度：${e.confidence}</p>\n          <p>发生时间：${l(1e3*e.time)}</p>\n        </div>\n    `,a=document.createElement("div");a.id="fuck-wrapper",a.style.left="0px",a.style.width="20%",a.style.color="#fff",a.style.bottom="0px",a.style.height="150px",a.style.zIndex="99999",a.style.position="fixed",a.style.fontSize="14px",a.style.backgroundColor="rgb(0, 0, 0, 0, 0.5)",a.innerHTML=n(e),document.body.appendChild(a),setTimeout((()=>{const e=document.getElementsByClassName("el-image-viewer__prev")[0],t=document.getElementsByClassName("el-image-viewer__next")[0],s=()=>a.innerHTML=n((()=>{const e=document.getElementsByClassName("el-image-viewer__img")[0],[,t]=e.src.split("/images/");return b.value.find((e=>e.image.includes(t)))})());null==e||e.addEventListener("click",s),null==t||t.addEventListener("click",s);const l=e=>{"ArrowRight"!==e.key&&"ArrowLeft"!==e.key||s()};document.addEventListener("keydown",l);const r=()=>{if(!document.body.contains(document.getElementsByClassName("el-image-viewer__wrapper")[0])){const n=document.getElementById("fuck-wrapper");n&&(document.body.removeChild(n),document.body.removeEventListener("click",r),null==e||e.removeEventListener("click",s),null==t||t.removeEventListener("click",s),document.removeEventListener("keydown",l))}};document.body.addEventListener("click",r)}))},handleChangeSize:e=>h.value.size=e,handleChangePage:e=>h.value.page=e,dates:o,names:p,events:w,cameras:m,eventImages:k}})),m={setup:(e,t)=>{const{dates:n,names:a,cameras:s,params:l,loading:r,request:i,handleReset:o}=u.serviceDiscovery();return{dates:n,names:a,cameras:s,params:l,loading:r,request:i,handleReset:o}}};const v={};var f=p(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-tooltip",{attrs:{effect:"dark",content:"刷新"}},[n("el-button",{attrs:{circle:"",size:"small",type:"primary",icon:"el-icon-refresh",loading:e.loading},on:{click:e.request}})],1),n("el-divider",{attrs:{direction:"vertical"}}),n("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择事件名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}},e._l(Object.keys(e.names),(function(t){return n("el-option",{key:t,attrs:{label:t+"（"+e.names[t]+"）",value:t}})})),1),n("el-divider",{attrs:{direction:"vertical"}}),n("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择摄像头"},model:{value:e.params.camera,callback:function(t){e.$set(e.params,"camera",t)},expression:"params.camera"}},e._l(e.cameras,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1),n("el-divider",{attrs:{direction:"vertical"}}),n("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}}),n("el-divider",{attrs:{direction:"vertical"}}),n("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-refresh-left",loading:e.loading},on:{click:e.handleReset}},[e._v("重置")])],1)}),[],!1,g,null,null,null);function g(e){for(let t in v)this[t]=v[t]}var h=function(){return f.exports}();const _={setup:(e,t)=>{const{total:n,params:a,events:s,eventImages:r,loading:i,handleChangeSize:o,handleChangePage:c,handlePreview:d}=u.serviceDiscovery();return{useDateFormatter:l,total:n,params:a,events:s,eventImages:r,loading:i,handleChangeSize:o,handleChangePage:c,handlePreview:d}}};_.components=Object.assign({RecordsToolbar:h},_.components);const b={};var y=p(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("RecordsToolbar"),n("el-divider"),n("div",{staticStyle:{width:"100%"}},e._l(e.events,(function(t,a){return n("el-row",{key:a,style:{marginTop:a?"16px":0},attrs:{type:"flex",gutter:16,justify:t.length<6?"start":" space-between"}},e._l(t,(function(t){return n("el-col",{key:t.id,attrs:{span:4}},[n("el-tooltip",{attrs:{effect:"dark","open-delay":300,placement:"top"},scopedSlots:e._u([{key:"content",fn:function(){return[n("p",[e._v("名字：谭前程")]),n("p",[e._v("事件编号："+e._s(t.id))]),n("p",[e._v("事件名称："+e._s(t.name))]),n("p",[e._v("摄像头名称："+e._s(t.camera))]),n("p",[e._v("置信度："+e._s(t.confidence))]),n("p",[e._v("发生时间："+e._s(e.useDateFormatter(1e3*t.time)))])]},proxy:!0}],null,!0)},[n("div",{staticClass:"event-card"},[n("el-image",{staticStyle:{width:"100%","border-radius":"5px"},attrs:{src:t.image,"preview-src-list":e.eventImages},on:{click:function(n){return e.handlePreview(t)}},scopedSlots:e._u([{key:"error",fn:function(){return[n("span",[e._v("加载中 ...")])]},proxy:!0}],null,!0)}),n("div",{staticClass:"info"},[n("el-row",{staticClass:"row"},[n("p",[e._v("谭前程")]),n("p",[e._v(" "+e._s(t.name))]),n("p",{staticStyle:{"font-size":"12px"}},[e._v(e._s(e.useDateFormatter(1e3*t.time)))])])],1)],1)])],1)})),1)})),1),n("el-divider"),n("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total,"page-size":e.params.size,"page-sizes":[6,18,30,42,54],"current-page":e.params.page},on:{"size-change":e.handleChangeSize,"current-change":e.handleChangePage}})],1)}),[],!1,w,"4be8ec35",null,null);function w(e){for(let t in b)this[t]=b[t]}var k=function(){return y.exports}();const x=o((function(){const[e,t]=c(!1);return{visible:e,setVisible:t}})),C={setup:(e,t)=>{const{visible:n}=x.serviceDiscovery();return{Wallpaper:"/assets/wallpaper.49318d59.jpg",visible:n}}};const z={};var E=p(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{attrs:{size:"40%",direction:"ltr","show-close":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",[n("i",{staticClass:"m-r-8 el-icon-view"}),n("span",[e._v("查看详情")])])]},proxy:!0}])},[n("el-image",{staticStyle:{width:"100%"},attrs:{src:e.Wallpaper,"preview-src-list":[e.Wallpaper]}}),n("el-divider"),n("el-descriptions",{attrs:{border:"",title:"详细信息",column:3}},[n("el-descriptions-item",[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"m-r-8 el-icon-user"}),n("span",[e._v("编号")])]),n("span",[e._v("12345678")])]),n("el-descriptions-item",[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"m-r-8 el-icon-user"}),n("span",[e._v("发生时间")])]),n("span",[e._v("2019-04-24 18:00:00")])]),n("el-descriptions-item",[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"m-r-8 el-icon-user"}),n("span",[e._v("处理状态")])]),n("span",[e._v("已处理")])]),n("el-descriptions-item",[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"m-r-8 el-icon-user"}),n("span",[e._v("是否误报")])]),n("span",[e._v("是")])]),n("el-descriptions-item",[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"m-r-8 el-icon-user"}),n("span",[e._v("事件类型")])]),n("span",[e._v("斗殴")])])],1)],1)}),[],!1,j,null,null,null);function j(e){for(let t in z)this[t]=z[t]}var R=function(){return E.exports}();const S={setup:(e,t)=>(x.serviceRegister(),{})};S.components=Object.assign({Records:k,Instance:R},S.components);const $={};var I=p(S,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("Records"),t("Instance")],1)}),[],!1,L,null,null,null);function L(e){for(let t in $)this[t]=$[t]}var P=function(){return I.exports}();const T={setup:(e,t)=>(u.serviceRegister(),{})};T.components=Object.assign({IndexWrapper:P},T.components);const B={};var D=p(T,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("IndexWrapper")],1)}),[],!1,q,null,null,null);function q(e){for(let t in B)this[t]=B[t]}var N=function(){return D.exports}();export{N as default};
